# Project Structure

## Overview

Listly follows **Next.js 14 App Router** conventions with a mobile-first PWA architecture. This structure prioritizes code organization, separation of concerns, and scalability for a shopping companion application with real-time collaboration.

---

## Directory Map

| Directory | Purpose | Examples |
|-----------|---------|----------|
| `.github/` | GitHub workflows, issue templates, PR templates | `pull_request_template.md` |
| `.prompts/` | AI session tracking and development logs | `AI-SESSION.md` |
| `.sops/` | Standard Operating Procedures for development | Phase-based SOP documentation |
| `docs/` | Project documentation | `requirements.md`, `tech-stack.md` |
| `docs/architecture/` | Architectural decisions and design patterns | `project-structure.md`, `design-patterns.md` |
| `docs/database/` | Database schema and ERD documentation | `erd.md`, migrations docs |
| `prisma/` | Database schema, migrations, and seed data | `schema.prisma`, `migrations/` |
| `prisma/migrations/` | Database migration files | Auto-generated by Prisma |
| `public/` | Static assets served directly (images, fonts, manifest) | `manifest.json`, `icons/` |
| `public/images/` | Static images and graphics | Logos, placeholder images |
| `public/fonts/` | Custom web fonts | `.woff2` font files |
| `src/` | Source code root | All application code |
| `src/app/` | Next.js App Router pages, layouts, and API routes | `page.tsx`, `layout.tsx` |
| `src/app/(auth)/` | Route group for authentication pages | `login/`, `register/` |
| `src/app/(dashboard)/` | Route group for authenticated dashboard | `dashboard/` |
| `src/app/api/` | API route handlers | `auth/`, REST endpoints |
| `src/components/` | Reusable React components | UI library |
| `src/components/ui/` | Base UI components (buttons, inputs, cards) | `Button.tsx`, `Input.tsx` |
| `src/components/forms/` | Form components and form-specific UI | `LoginForm.tsx`, `ListForm.tsx` |
| `src/components/layout/` | Layout components (header, footer, navigation) | `Header.tsx`, `Footer.tsx` |
| `src/components/features/` | Feature-specific components | `ShoppingList.tsx`, `PantryInventory.tsx` |
| `src/lib/` | Utility libraries and shared configurations | `db.ts`, `auth.ts`, `utils.ts` |
| `src/hooks/` | Custom React hooks | `useAuth.ts`, `useShoppingList.ts` |
| `src/types/` | TypeScript type definitions and interfaces | `index.ts`, `shopping-list.ts` |
| `src/services/` | Business logic and API integration services | `listService.ts`, `aiService.ts` |
| `src/config/` | Application configuration and constants | `site.ts`, `navigation.ts` |
| `tests/` | Test files organized by type | Unit and integration tests |
| `tests/unit/` | Unit tests for individual functions and components | `*.test.ts` |
| `tests/integration/` | Integration tests for API and features | End-to-end test scenarios |

---

## Key Design Principles

### 1. Colocation
Related files are kept together to improve discoverability and maintainability.

```
components/
  └── ShoppingListCard/
      ├── ShoppingListCard.tsx        # Component
      ├── ShoppingListCard.test.tsx   # Test
      └── index.ts                    # Export
```

### 2. Separation of Concerns
Clear boundaries between presentation (components), logic (services), and data (lib/db).

```
User adds item to list
  ↓
1. Component (UI) → src/components/features/AddItemForm.tsx
  ↓
2. Service (Logic) → src/services/listService.ts
  ↓
3. Database (Data) → src/lib/db.ts (Prisma Client)
```

### 3. Route Groups
App Router uses route groups `(group)` to organize routes without affecting URL structure.

```
src/app/
  ├── (auth)/              # Route group (not in URL)
  │   ├── login/page.tsx   # URL: /login
  │   └── register/page.tsx # URL: /register
  └── (dashboard)/         # Route group (not in URL)
      └── dashboard/page.tsx # URL: /dashboard
```

---

## File Naming Conventions

| Type | Convention | Example | Rationale |
|------|------------|---------|-----------|
| React Components | PascalCase | `UserCard.tsx` | Industry standard for React |
| Utilities/Hooks | camelCase | `useAuth.ts`, `formatDate.ts` | Standard JS naming |
| Routes/Pages | kebab-case (folders) | `user-profile/page.tsx` | URL-friendly, Next.js convention |
| Config files | kebab-case | `tailwind.config.ts` | Standard for config files |
| Tests | Source name + `.test` | `UserCard.test.tsx` | Clear test identification |
| API Routes | kebab-case | `api/shopping-lists/route.ts` | URL-friendly endpoints |
| Types | PascalCase (interfaces/types) | `ShoppingList` | TypeScript convention |
| Constants | SCREAMING_SNAKE_CASE | `MAX_LIST_SIZE` | Inside files, not filenames |

---

## Import Aliases

Path aliases are configured in `tsconfig.json` to enable clean imports:

| Alias | Resolves To | Example |
|-------|-------------|---------|
| `@/*` | `./src/*` | `import { db } from '@/lib/db'` |
| `@/components/*` | `./src/components/*` | `import { Button } from '@/components/ui'` |
| `@/lib/*` | `./src/lib/*` | `import { formatDate } from '@/lib/utils'` |
| `@/hooks/*` | `./src/hooks/*` | `import { useAuth } from '@/hooks/useAuth'` |
| `@/types/*` | `./src/types/*` | `import type { User } from '@/types'` |
| `@/services/*` | `./src/services/*` | `import { listService } from '@/services/listService'` |
| `@/config/*` | `./src/config/*` | `import { siteConfig } from '@/config/site'` |

### Usage Example

**Bad (relative paths):**
```typescript
import { Button } from '../../../../components/ui/Button';
import { useAuth } from '../../../hooks/useAuth';
```

**Good (path aliases):**
```typescript
import { Button } from '@/components/ui';
import { useAuth } from '@/hooks/useAuth';
```

---

## Barrel Files (index.ts)

Barrel files provide clean exports and make imports simpler:

**File:** `src/components/ui/index.ts`
```typescript
export { Button } from './Button';
export { Input } from './Input';
export { Card } from './Card';
```

**Usage:**
```typescript
// Import multiple components from one path
import { Button, Input, Card } from '@/components/ui';

// Instead of
import { Button } from '@/components/ui/Button';
import { Input } from '@/components/ui/Input';
import { Card } from '@/components/ui/Card';
```

**Note:** Barrel files are created in:
- `src/components/ui/`
- `src/components/forms/`
- `src/components/layout/`
- `src/components/features/`

---

## Module Boundaries

Clear boundaries help maintain code quality and prevent circular dependencies:

```
┌─────────────────────────────────────┐
│          Components Layer           │
│  (Presentation, UI, User Interface) │
│  ↓ Uses                             │
│  • Hooks                            │
│  • Services (for data)              │
│  • Types                            │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│           Services Layer            │
│    (Business Logic, API Calls)      │
│  ↓ Uses                             │
│  • lib/db (Prisma)                  │
│  • lib/utils                        │
│  • Types                            │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│             Lib Layer               │
│  (Database, Auth, Core Utilities)   │
│  ↓ Uses                             │
│  • External packages                │
│  • Types                            │
└─────────────────────────────────────┘
```

**Rules:**
- ✅ Components can use hooks, services, and types
- ✅ Services can use lib utilities and database
- ✅ Lib utilities should be framework-agnostic when possible
- ❌ Lib should NOT import from components or services
- ❌ Avoid circular dependencies between services

---

## Next.js App Router Specifics

### File Conventions

| File | Purpose | Example |
|------|---------|---------|
| `layout.tsx` | Shared UI wrapper for route segment | Root layout with nav |
| `page.tsx` | Route page (makes path publicly accessible) | `/dashboard/page.tsx` |
| `loading.tsx` | Loading UI (Suspense fallback) | Skeleton screens |
| `error.tsx` | Error UI boundary | Error handling |
| `not-found.tsx` | 404 page | Custom 404 |
| `route.ts` | API endpoint | REST API handlers |

### Route Examples

```
src/app/
├── layout.tsx                   # Root layout
├── page.tsx                     # Home page (/)
├── (auth)/
│   ├── layout.tsx              # Auth layout
│   ├── login/
│   │   └── page.tsx            # /login
│   └── register/
│       └── page.tsx            # /register
├── (dashboard)/
│   ├── layout.tsx              # Dashboard layout
│   └── dashboard/
│       └── page.tsx            # /dashboard
└── api/
    └── auth/
        └── [...nextauth]/
            └── route.ts        # NextAuth.js API endpoint
```

---

## Feature Modules

As the app grows, features can be organized into self-contained modules:

```
src/components/features/
├── shopping-list/
│   ├── ShoppingListCard.tsx
│   ├── ShoppingListItem.tsx
│   ├── AddItemForm.tsx
│   └── index.ts
├── pantry/
│   ├── PantryInventory.tsx
│   ├── ExpirationAlert.tsx
│   └── index.ts
└── meal-planning/
    ├── MealCalendar.tsx
    ├── RecipeCard.tsx
    └── index.ts
```

This structure supports:
- ✅ Easy feature discovery
- ✅ Independent testing
- ✅ Clear ownership
- ✅ Potential extraction to packages

---

## Related Documentation

- [Requirements](../requirements.md) - Feature requirements and user stories
- [Tech Stack](../tech-stack.md) - Technology decisions and rationale
- [Design Patterns](./design-patterns.md) - Architecture patterns (coming soon)
- [Setup Guide](../setup.md) - Development environment setup (coming soon)

---

## Maintenance

**When adding new features:**
1. Follow existing naming conventions
2. Use path aliases for imports
3. Export from barrel files when appropriate
4. Keep related files colocated
5. Update this document if structure changes significantly

**When refactoring:**
- Maintain module boundaries
- Update imports and exports
- Run tests to catch broken imports
- Update documentation
